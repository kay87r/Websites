import React, { useState, useRef } from 'react';
// Import html2canvas and jspdf from CDN for direct use in the browser environment
// In a typical React project, these would be installed via npm/yarn and imported directly.

// Define all template styles globally, accessible by both App and BillPreview
const templateStyles = {
  modern: {
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 border-b border-dashed border-gray-400 pb-2",
    restaurantInfoClasses: "text-center mb-4 text-xs",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-500 text-xs mt-4",
    previewContainerClasses: "p-4 bg-white shadow-2xl border border-gray-200 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-100",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false, // Default: No shuffle
    billInfoInFooter: false, // Default: In header area
  },
  classic: {
    headerClasses: "text-xl font-serif text-center text-gray-900 mb-4 border-b border-dashed border-gray-400 pb-2",
    restaurantInfoClasses: "text-center mb-4 font-serif text-xs",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-600 text-xs italic mt-4",
    previewContainerClasses: "p-4 bg-white shadow-2xl border border-gray-200 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-100",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-serif",
    showItemBorders: false,
    shuffleBillInfo: true, // Shuffle for classic
    billInfoInFooter: false,
  },
  minimal: {
    headerClasses: "text-lg font-semibold text-center text-gray-800 mb-3 pb-1 border-b border-dashed border-gray-300",
    restaurantInfoClasses: "text-center mb-3 text-xs",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-500 text-xs mt-3",
    previewContainerClasses: "p-4 bg-white shadow-2xl border border-gray-200 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-transparent",
    tableRowBorderClass: "border-b border-dashed border-gray-200",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'crushed': { // Default for random crushed
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 border-b-2 border-gray-400 pb-2",
    restaurantInfoClasses: "text-center mb-4 text-sm",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-700 text-xs mt-4 font-semibold",
    previewContainerClasses: "p-4 shadow-2xl border border-gray-300 transition-all duration-300 ease-in-out max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-100",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
    // Dynamic styles for crushed are handled below via previewContainerStyle
  },
  'crushed-A': { // Specific crushed templates can inherit or override
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 border-b-2 border-gray-400 pb-2",
    restaurantInfoClasses: "text-center mb-4 text-sm",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-700 text-xs mt-4 font-semibold",
    previewContainerClasses: "p-4 shadow-2xl border border-gray-300 transition-all duration-300 ease-in-out max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-100",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'crushed-B': {
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 border-b-2 border-gray-400 pb-2",
    restaurantInfoClasses: "text-center mb-4 text-sm",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-700 text-xs mt-4 font-semibold",
    previewContainerClasses: "p-4 shadow-2xl border border-gray-300 transition-all duration-300 ease-in-out max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-100",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'crushed-C': {
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 border-b-2 border-gray-400 pb-2",
    restaurantInfoClasses: "text-center mb-4 text-sm",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-700 text-xs mt-4 font-semibold",
    previewContainerClasses: "p-4 shadow-2xl border border-gray-300 transition-all duration-300 ease-in-out max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-100",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'crushed-D': {
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 border-b-2 border-gray-400 pb-2",
    restaurantInfoClasses: "text-center mb-4 text-sm",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-700 text-xs mt-4 font-semibold",
    previewContainerClasses: "p-4 shadow-2xl border border-gray-300 transition-all duration-300 ease-in-out max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-100",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'crushed-E': {
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 border-b-2 border-gray-400 pb-2",
    restaurantInfoClasses: "text-center mb-4 text-sm",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-700 text-xs mt-4 font-semibold",
    previewContainerClasses: "p-4 shadow-2xl border border-gray-300 transition-all duration-300 ease-in-out max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-100",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  receipt: {
    headerClasses: "text-lg font-bold text-center mb-2 pb-1 border-b border-dashed border-gray-400",
    restaurantInfoClasses: "text-center mb-2 text-xs",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-xs mt-2",
    previewContainerClasses: "p-3 bg-white shadow-md border border-gray-200 max-w-[14rem] mx-auto font-mono text-xs",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-transparent",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-0.5 px-0.5",
    fontFamilyClass: "font-mono",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  bold: {
    headerClasses: "text-2xl font-extrabold text-center text-gray-900 mb-6 border-b-4 border-blue-600 pb-3",
    restaurantInfoClasses: "text-center mb-6 text-base font-semibold",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-700 text-base font-bold mt-8",
    previewContainerClasses: "p-4 bg-white shadow-2xl border border-gray-200 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-blue-600 text-white",
    tableRowBorderClass: "border-b border-gray-200",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: true, // Shuffle for bold
    billInfoInFooter: false,
  },
  'retro-dot-matrix': {
    headerClasses: "text-xl font-bold text-center text-gray-800 mb-4 border-b border-dashed border-gray-500 pb-2",
    restaurantInfoClasses: "text-center mb-4 text-xs tracking-wide",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-600 text-xs mt-4 tracking-wide",
    previewContainerClasses: "p-4 bg-white shadow-md border border-gray-300 max-w-sm mx-auto font-mono text-xs bg-gradient-to-b from-gray-50 to-gray-100",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-200",
    tableRowBorderClass: "border-b border-dashed border-gray-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-mono",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'clean-boxed': {
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 pb-2 border-b border-gray-300",
    restaurantInfoClasses: "text-center mb-4 p-2 border border-gray-200 rounded-md bg-gray-50 text-xs",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-600 text-xs mt-4",
    previewContainerClasses: "p-4 bg-white rounded-lg shadow-lg border border-gray-200 max-w-sm mx-auto",
    tableBorderClass: "border border-gray-300",
    tableHeaderBgClass: "bg-blue-50",
    tableRowBorderClass: "border-b border-gray-200",
    tableCellPaddingClass: "py-2 px-3",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'elegant-line': {
    headerClasses: "text-2xl font-light text-center text-gray-800 mb-6 border-b border-gray-300 pb-3 tracking-wide",
    restaurantInfoClasses: "text-center mb-6 text-xs italic",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-500 text-xs mt-6",
    previewContainerClasses: "p-5 bg-white rounded-lg shadow-xl border border-gray-100 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-transparent",
    tableRowBorderClass: "border-b border-gray-200",
    tableCellPaddingClass: "py-1.5 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'dark-accent': {
    headerClasses: "text-xl font-bold text-center text-white bg-gray-800 py-2 rounded-t-lg -mx-4 -mt-4 mb-4",
    restaurantInfoClasses: "text-center mb-4 text-xs text-gray-700",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-600 text-xs mt-4",
    previewContainerClasses: "p-4 bg-gray-50 rounded-lg shadow-xl border border-gray-300 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-700 text-white",
    tableRowBorderClass: "border-b border-gray-200",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'simple-grid': {
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 pb-2",
    restaurantInfoClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-500 text-xs mt-4",
    previewContainerClasses: "p-4 bg-white rounded-lg shadow-md border border-gray-100 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-50",
    tableRowBorderClass: "border-b border-gray-100",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  // NEW TEMPLATES
  'modern-compact': {
    headerClasses: "text-lg font-bold text-center text-gray-900 mb-3 border-b border-dashed border-gray-400 pb-1.5",
    restaurantInfoClasses: "text-center mb-3 text-xs leading-tight",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-3 border-b border-dashed border-gray-400 pb-1.5 text-center",
    thankYouClasses: "text-center text-gray-500 text-xs mt-3",
    previewContainerClasses: "p-3 bg-white shadow-xl border border-gray-200 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-50",
    tableRowBorderClass: "border-b border-dashed border-gray-200",
    tableCellPaddingClass: "py-0.5 px-1",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: false,
  },
  'elegant-minimal': {
    headerClasses: "text-xl font-light text-center text-gray-700 mb-5 border-b border-gray-200 pb-2.5 tracking-wide",
    restaurantInfoClasses: "text-center mb-5 text-xs italic text-gray-500",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-400 text-xs mt-5",
    previewContainerClasses: "p-5 bg-white rounded-lg shadow-xl border border-gray-100 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-white",
    tableRowBorderClass: "border-b border-gray-100",
    tableCellPaddingClass: "py-1.5 px-2",
    fontFamilyClass: "font-serif",
    showItemBorders: false,
    shuffleBillInfo: true, // Shuffle for elegant-minimal
    billInfoInFooter: false,
  },
  'dark-professional': {
    headerClasses: "text-xl font-bold text-center text-white bg-gray-900 py-3 rounded-t-lg -mx-4 -mt-4 mb-4",
    restaurantInfoClasses: "text-center mb-4 text-xs text-gray-200",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-300 text-xs mb-4 border-b border-dashed border-gray-600 pb-2 text-center",
    thankYouClasses: "text-center text-gray-400 text-xs mt-4",
    previewContainerClasses: "p-4 bg-gray-800 rounded-lg shadow-xl border border-gray-700 max-w-sm mx-auto text-white",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-700 text-white",
    tableRowBorderClass: "border-b border-gray-600",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: true, // Move to footer for dark-professional
  },
  'colorful-gradient': {
    headerClasses: "text-2xl font-extrabold text-center text-white mb-6 py-3 rounded-lg bg-gradient-to-r from-purple-500 to-pink-500",
    restaurantInfoClasses: "text-center mb-6 text-sm text-gray-700",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-600 text-sm mt-8",
    previewContainerClasses: "p-4 bg-white rounded-xl shadow-2xl border border-gray-200 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-blue-100",
    tableRowBorderClass: "border-b border-gray-200",
    tableCellPaddingClass: "py-1.5 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    swapItemQty: true, // Swap for colorful-gradient
    shuffleBillInfo: true, // Shuffle for colorful-gradient
    billInfoInFooter: true, // Move to footer for colorful-gradient
  },
  // NEW TEMPLATES FOR SHUFFLE/FOOTER DEMO
  'corporate-clean': {
    headerClasses: "text-xl font-bold text-center text-gray-900 mb-4 pb-2 border-b-2 border-gray-300",
    restaurantInfoClasses: "text-center mb-4 text-xs",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-600 text-xs mt-4",
    previewContainerClasses: "p-4 bg-white rounded-lg shadow-lg border border-gray-200 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-gray-100",
    tableRowBorderClass: "border-b border-dashed border-gray-200",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-inter",
    showItemBorders: false,
    shuffleBillInfo: false,
    billInfoInFooter: true, // Move to footer
  },
  'rustic-charm': {
    headerClasses: "text-xl font-bold text-center text-gray-800 mb-4 pb-2 border-b border-gray-400",
    restaurantInfoClasses: "text-center mb-4 text-sm font-serif italic",
    billInfoGridClasses: "grid grid-cols-1 gap-y-0.5 text-gray-700 text-xs mb-4 border-b border-dashed border-gray-400 pb-2 text-center",
    thankYouClasses: "text-center text-gray-700 text-xs mt-4",
    previewContainerClasses: "p-5 bg-yellow-50 rounded-lg shadow-xl border border-yellow-200 max-w-sm mx-auto",
    tableBorderClass: "border-none",
    tableHeaderBgClass: "bg-yellow-100",
    tableRowBorderClass: "border-b border-dashed border-yellow-300",
    tableCellPaddingClass: "py-1 px-2",
    fontFamilyClass: "font-serif",
    showItemBorders: false,
    shuffleBillInfo: true, // Shuffle
    billInfoInFooter: false,
  },
};

// Main App component
const App = () => {
  // State to hold the list of bill items for the currently active bill
  const [items, setItems] = useState([]);
  // State for new item input fields
  const [itemName, setItemName] = useState('');
  const [itemQuantity, setItemQuantity] = useState(1);
  const [itemPrice, setItemPrice] = useState('');
  // State for tax rate (e.g., 10%)
  const [taxRate, setTaxRate] = useState(10); // Default tax rate

  // States for restaurant and bill details for the currently active bill
  const [restaurantName, setRestaurantName] = useState('My Awesome Restaurant');
  const [address, setAddress] = useState('123 Main St, Anytown, USA');
  const [tableNo, setTableNo] = useState('');
  const [invoiceNumber, setInvoiceNumber] = useState('');

  // Combined state for Bill Date and Time
  const now = new Date();
  const initialDateTime = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}T${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
  const [billDateTime, setBillDateTime] = useState(initialDateTime);

  const [paymentMethod, setPaymentMethod] = useState('Cash');
  const [vatNumber, setVatNumber] = useState('');

  // State for currency selection
  const [currency, setCurrency] = useState('USD'); // Default currency

  // State for selecting the bill preview template
  const [billTemplate, setBillTemplate] = useState('modern'); // Default template

  // State for PDF generation loading
  const [pdfLoading, setPdfLoading] = useState(false);

  // Ref for the BillPreview component to capture its content
  const billPreviewRef = useRef(null);

  // List of major currencies with their symbols
  const currencies = [
    { code: 'USD', symbol: '$' },
    { code: 'EUR', symbol: '€' },
    { code: 'GBP', symbol: '£' },
    { code: 'JPY', symbol: '¥' },
    { code: 'CAD', symbol: 'C$' },
    { code: 'AUD', symbol: 'A$' },
    { code: 'CHF', symbol: 'CHF' },
    { code: 'CNY', symbol: '¥' },
    { code: 'INR', symbol: '₹' },
    { code: 'AED', symbol: 'د.إ' }, // UAE Dirham
    { code: 'SAR', symbol: 'ر.س' }, // Saudi Riyal
    { code: 'JOD', symbol: 'JD' },  // Jordanian Dinar
    { code: 'MXN', symbol: '$' },
    { code: 'BRL', symbol: 'R$' },
  ];

  // Function to get currency symbol based on selected currency code
  const getCurrencySymbol = (code) => {
    const found = currencies.find(c => c.code === code);
    return found ? found.symbol : '';
  };

  // Calculate subtotal for the currently active bill
  const subtotal = items.reduce((sum, item) => sum + (item.quantity * item.price), 0);
  // Calculate tax amount for the currently active bill
  const taxAmount = (subtotal * taxRate) / 100;
  // Calculate grand total for the currently active bill
  const total = subtotal + taxAmount;

  // Function to add a new item to the bill
  const handleAddItem = () => {
    // Validate inputs
    if (itemName.trim() === '' || itemPrice === '' || isNaN(parseFloat(itemPrice))) {
      console.error('Please enter a valid item name and price.');
      return;
    }

    const newItem = {
      id: Date.now(), // Unique ID for the item
      name: itemName.trim(),
      quantity: parseInt(itemQuantity, 10),
      price: parseFloat(itemPrice),
    };

    setItems([...items, newItem]); // Add new item to the list
    // Reset input fields
    setItemName('');
    setItemQuantity(1);
    setItemPrice('');
  };

  // Function to remove an item from the bill by its ID
  const handleRemoveItem = (id) => {
    setItems(items.filter(item => item.id !== id));
  };

  // Function to clear all items from the bill
  const handleClearAll = () => {
    setItems([]);
    setItemName('');
    setItemQuantity(1);
    setItemPrice('');
    // Reset restaurant details to default or empty
    setRestaurantName('My Awesome Restaurant');
    setAddress('123 Main St, Anytown, USA');
    setTableNo('');
    setInvoiceNumber('');
    setBillDateTime(initialDateTime); // Reset combined date/time
    setPaymentMethod('Cash');
    setVatNumber('');
    setTaxRate(10);
    setCurrency('USD'); // Reset currency
  };

  // Function to generate PDF
  const handleGeneratePdf = async () => {
    setPdfLoading(true);
    if (!billPreviewRef.current) {
      console.error("Bill preview element not found for PDF generation.");
      setPdfLoading(false);
      return;
    }

    // Load html2canvas and jspdf dynamically
    // These script tags are usually in index.html, but for a self-contained React component
    // in this environment, we'll ensure they are loaded if not already.
    if (typeof html2canvas === 'undefined' || typeof jspdf === 'undefined') {
      console.warn("PDF libraries not found. Attempting to load...");
      const html2canvasScript = document.createElement('script');
      html2canvasScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
      document.body.appendChild(html2canvasScript);

      const jspdfScript = document.createElement('script');
      jspdfScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
      document.body.appendChild(jspdfScript);

      // Wait for scripts to load
      await Promise.all([
        new Promise(resolve => html2canvasScript.onload = resolve),
        new Promise(resolve => jspdfScript.onload = resolve)
      ]);
      console.log("PDF libraries loaded.");
    }


    try {
      const canvas = await html2canvas(billPreviewRef.current, { scale: 2 }); // Scale for better resolution
      const imgData = canvas.toDataURL('image/png');
      const pdf = new window.jspdf.jsPDF({
        orientation: 'portrait',
        unit: 'px',
        format: [canvas.width, canvas.height] // Use canvas dimensions for PDF size
      });

      pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height);
      pdf.save(`bill-${invoiceNumber || 'preview'}.pdf`);
    } catch (error) {
      console.error("Error generating PDF:", error);
    } finally {
      setPdfLoading(false);
    }
  };


  // Component to render the main bill preview based on selected template
  const BillPreview = ({ template = 'modern', billPreviewRef }) => {
    // Format billDateTime for display
    let formattedBillDateTime;
    try {
      const dateObj = new Date(billDateTime);
      if (isNaN(dateObj.getTime())) { // Check for invalid date
        formattedBillDateTime = 'Invalid Date';
      } else {
        const options = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit', hour12: true };
        formattedBillDateTime = dateObj.toLocaleString('en-US', options);
      }
    } catch (e) {
      formattedBillDateTime = 'Error Formatting Date';
      console.error("Date formatting error:", e);
    }

    const currentCurrencySymbol = getCurrencySymbol(currency);

    // Get the current template's styles, with a fallback to 'modern' if template is not found
    const currentStyle = templateStyles[template] || templateStyles.modern;

    // Base classes for common elements (these are consistent across templates)
    // These are for the BillPreview's internal table
    const previewBaseThClasses = "py-1 px-2 text-left text-xs font-semibold text-gray-700";
    const previewBaseTdClasses = "py-1 px-2 text-gray-800 text-xs";
    const baseTotalSectionClasses = "flex flex-col items-end space-y-1 text-xs font-semibold text-gray-800 border-t border-dashed border-gray-400 pt-2 mt-2";
    const baseTotalRowClasses = "flex justify-between w-full max-w-[12rem]";
    const baseGrandTotalClasses = "flex justify-between w-full max-w-[12rem] text-sm font-bold text-blue-700 pt-1";

    // Handle dynamic style for 'crushed' templates
    let previewContainerStyle = {};
    if (template.startsWith('crushed')) {
      const randomRotation = (Math.random() * 4 - 2).toFixed(2);
      const randomTranslateX = (Math.random() * 8 - 4).toFixed(2);
      const randomTranslateY = (Math.random() * 8 - 4).toFixed(2);
      const randomScale = (1 + Math.random() * 0.02 - 0.01).toFixed(3);
      const randomShadowOffset = (Math.random() * 6 + 1).toFixed(0);
      const randomShadowBlur = (Math.random() * 10 + 3).toFixed(0);
      const randomBorderRadius = (Math.random() * 8 + 3).toFixed(0);
      const randomHue = Math.floor(Math.random() * 30) + 30;
      const randomSaturation = Math.floor(Math.random() * 20) + 80;
      const randomLightness = Math.floor(Math.random() * 10) + 90;

      previewContainerStyle = {
        transform: `rotate(${randomRotation}deg) translateX(${randomTranslateX}px) translateY(${randomTranslateY}px) scale(${randomScale})`,
        boxShadow: `${randomShadowOffset}px ${randomShadowOffset}px ${randomShadowBlur}px rgba(0,0,0,0.3)`,
        borderRadius: `${randomBorderRadius}px`,
        backgroundColor: `hsl(${randomHue}, ${randomSaturation}%, ${randomLightness}%)`,
        backgroundImage: `url("data:image/svg+xml,%3Csvg width='6' height='6' viewBox='0 0 6 6' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%239C92AC' fill-opacity='0.1' fill-rule='evenodd'%3E%3Cpath d='M9 10L7 10V8L9 8V10ZM11 0L9 0V2L11 2V0ZM13 4L11 4V6L13 6V4ZM11 8L9 8V10L11 10V8ZM9 2L7 2V4L9 4V2ZM13 0L11 0V2L13 2V0ZM7 6L5 6V8L7 8V6ZM5 0L3 0V2L5 2V0ZM7 4L5 4V6L7 6V4ZM3 8L1 8V10L3 10V8ZM1 2L-1 2V4L1 4V2ZM3 6L1 6V8L3 8V6ZM-1 0L-3 0V2L-1 2V0ZM5 10L3 10V8L5 8V10ZM3 4L1 4V6L3 6V4ZM-1 4L-3 4V6L-1 6V4ZM1 0L-1 0V2L1 2V0Z'/%3E%3C/g%3E%3C/svg%3E")`,
      };
    }

    // Bill Information items for rendering
    const billInfoItems = [
      { label: 'Invoice No', value: invoiceNumber || 'N/A' },
      { label: 'Date', value: formattedBillDateTime },
      { label: 'Table No', value: tableNo || 'N/A' },
      { label: 'Payment Method', value: paymentMethod },
    ];

    // Shuffle if specified
    const displayedBillInfo = currentStyle.shuffleBillInfo
      ? [...billInfoItems].sort(() => Math.random() - 0.5)
      : billInfoItems;

    const billInfoContent = (
      <div className={currentStyle.billInfoGridClasses}>
        {displayedBillInfo.map((info, index) => (
          <div key={index}><strong>{info.label}:</strong> {info.value}</div>
        ))}
      </div>
    );


    let billContent;
    if (items.length === 0) {
      billContent = <p className="text-center text-gray-500 py-4 text-xs">No items in the bill to preview.</p>;
    } else {
      // Conditional rendering for header based on swapItemQty
      const itemHeader = currentStyle.swapItemQty ? (
        <>
          <span className="w-1/6 text-center">Qty</span>
          <span className="w-1/2 text-left">Item</span>
          <span className="w-1/6 text-right">Price</span>
          <span className="w-1/6 text-right">Total</span>
        </>
      ) : (
        <>
          <span className="w-1/2 text-left">Item</span>
          <span className="w-1/6 text-center">Qty</span>
          <span className="w-1/6 text-right">Price</span>
          <span className="w-1/6 text-right">Total</span>
        </>
      );

      // Conditional rendering for each item row based on swapItemQty
      const itemRow = (item) => currentStyle.swapItemQty ? (
        <>
          <span className="w-1/6 text-center">{item.quantity}</span>
          <span className="w-1/2 text-left">{item.name}</span>
          <span className="w-1/6 text-right">{currentCurrencySymbol}{item.price.toFixed(2)}</span>
          <span className="w-1/6 text-right">{currentCurrencySymbol}{(item.quantity * item.price).toFixed(2)}</span>
        </>
      ) : (
        <>
          <span className="w-1/2 text-left">{item.name}</span>
          <span className="w-1/6 text-center">{item.quantity}</span>
          <span className="w-1/6 text-right">{currentCurrencySymbol}{item.price.toFixed(2)}</span>
          <span className="w-1/6 text-right">{currentCurrencySymbol}{(item.quantity * item.price).toFixed(2)}</span>
        </>
      );

      billContent = (
        <div className="mb-4 text-xs text-gray-800">
          {/* Item List Header - mimicking table headers without actual table */}
          <div className={`flex justify-between font-semibold pb-1 mb-1 ${currentStyle.tableHeaderBgClass} ${currentStyle.showItemBorders ? 'border-b border-dashed border-gray-300' : ''}`}>
            {itemHeader}
          </div>
          {items.map((item) => (
            <div key={item.id} className={`flex justify-between py-0.5 ${currentStyle.showItemBorders ? 'border-b border-dashed border-gray-200' : ''} last:border-b-0`}>
              {itemRow(item)}
            </div>
          ))}
        </div>
      );
    }


    return (
      <div ref={billPreviewRef} className={`${currentStyle.previewContainerClasses} ${currentStyle.fontFamilyClass}`} style={previewContainerStyle}>
        <h2 className={currentStyle.headerClasses}></h2> {/* Header is now empty */}

        <div className={currentStyle.restaurantInfoClasses}>
          <h3 className="text-lg font-bold text-gray-800">{restaurantName}</h3>
          <p className="text-gray-600">{address}</p>
          {vatNumber && <p className="text-gray-600">VAT No: {vatNumber}</p>}
        </div>

        {!currentStyle.billInfoInFooter && billInfoContent}

        {billContent}

        <div className={baseTotalSectionClasses}>
          <div className={baseTotalRowClasses}>
            <span>Subtotal:</span>
            <span>{currentCurrencySymbol}{subtotal.toFixed(2)}</span>
          </div>
          <div className={baseTotalRowClasses}>
            <span>Tax ({taxRate}%):</span>
            <span>{currentCurrencySymbol}{taxAmount.toFixed(2)}</span>
          </div>
          <div className={baseGrandTotalClasses}>
            <span>Grand Total:</span>
            <span>{currentCurrencySymbol}{total.toFixed(2)}</span>
          </div>
        </div>

        {currentStyle.billInfoInFooter && (
          <div className="mt-4 pt-2 border-t border-dashed border-gray-400">
            {billInfoContent}
          </div>
        )}

        <p className={currentStyle.thankYouClasses}>Thank you for your business!</p>
      </div>
    );
  };

  // Define base classes for the App component's internal table
  const appBaseThClasses = "py-3 px-4 text-left text-sm font-semibold text-gray-700";
  const appBaseTdClasses = "py-3 px-4 text-gray-800";

  // Get the current template's styles for the App component's internal table
  const appCurrentStyle = templateStyles[billTemplate] || templateStyles.modern;

  // Define the SVG path for the delete icon as a constant
  const deleteIconPath = "M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 011-1h4a1 1 0 110 2H8a1 1 0 01-1-1zm2 4a1 1 0 100 2h2a1 1 0 100-2H9z";


  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-100 to-purple-100 flex items-center justify-center p-4 font-inter">
      <div className="bg-white p-8 rounded-xl shadow-2xl max-w-4xl w-full border border-gray-200">
        <h1 className="text-4xl font-extrabold text-center text-gray-900 mb-8 tracking-tight">
          Restaurant Bill Generator
        </h1>

        {/* Restaurant and Bill Details Section */}
        <div className="mb-8 p-6 bg-green-50 rounded-lg border border-green-200 shadow-inner">
          <h2 className="text-2xl font-bold text-green-800 mb-5">Restaurant & Bill Information</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
            <div>
              <label htmlFor="restaurantName" className="block text-sm font-medium text-gray-700 mb-1">Restaurant Name</label>
              <input
                type="text"
                id="restaurantName"
                value={restaurantName}
                onChange={(e) => setRestaurantName(e.target.value)}
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-200"
              />
            </div>
            <div className="col-span-1 md:col-span-2">
              <label htmlFor="address" className="block text-sm font-medium text-gray-700 mb-1">Address</label>
              <input
                type="text"
                id="address"
                value={address}
                onChange={(e) => setAddress(e.target.value)}
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-200"
              />
            </div>
            <div>
              <label htmlFor="tableNo" className="block text-sm font-medium text-gray-700 mb-1">Table No.</label>
              <input
                type="text"
                id="tableNo"
                value={tableNo}
                onChange={(e) => setTableNo(e.target.value)}
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-200"
              />
            </div>
            <div>
              <label htmlFor="invoiceNumber" className="block text-sm font-medium text-gray-700 mb-1">Invoice No.</label>
              <input
                type="text"
                id="invoiceNumber"
                value={invoiceNumber}
                onChange={(e) => setInvoiceNumber(e.target.value)}
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-200"
              />
            </div>
            <div>
              <label htmlFor="vatNumber" className="block text-sm font-medium text-gray-700 mb-1">VAT No.</label>
              <input
                type="text"
                id="vatNumber"
                value={vatNumber}
                onChange={(e) => setVatNumber(e.target.value)}
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-200"
              />
            </div>
            <div className="col-span-full md:col-span-1"> {/* Make this span full width on small screens */}
              <label htmlFor="billDateTime" className="block text-sm font-medium text-gray-700 mb-1">Bill Date & Time</label>
              <input
                type="datetime-local"
                id="billDateTime"
                value={billDateTime}
                onChange={(e) => setBillDateTime(e.target.value)}
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-200"
              />
            </div>
            <div>
              <label htmlFor="paymentMethod" className="block text-sm font-medium text-gray-700 mb-1">Payment Method</label>
              <select
                id="paymentMethod"
                value={paymentMethod}
                onChange={(e) => setPaymentMethod(e.target.value)}
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-200 bg-white"
              >
                <option value="Cash">Cash</option>
                <option value="Credit Card">Credit Card</option>
                <option value="Debit Card">Debit Card</option>
                <option value="Online Payment">Online Payment</option>
                <option value="UPI">UPI</option>
              </select>
            </div>
            <div>
              <label htmlFor="currency" className="block text-sm font-medium text-gray-700 mb-1">Currency</label>
              <select
                id="currency"
                value={currency}
                onChange={(e) => setCurrency(e.target.value)}
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-200 bg-white"
              >
                {currencies.map((curr) => (
                  <option key={curr.code} value={curr.code}>
                    {curr.code} ({curr.symbol})
                  </option>
                ))}
              </select>
            </div>
          </div>
        </div>


        {/* Input Section */}
        <div className="mb-8 p-6 bg-blue-50 rounded-lg border border-blue-200 shadow-inner">
          <h2 className="text-2xl font-bold text-blue-800 mb-5">Add New Item</h2>
          <div className="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
            <div className="col-span-2">
              <label htmlFor="itemName" className="block text-sm font-medium text-gray-700 mb-1">Item Name</label>
              <input
                type="text"
                id="itemName"
                value={itemName}
                onChange={(e) => setItemName(e.target.value)}
                placeholder="e.g., Chicken Biryani"
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-200"
              />
            </div>
            <div>
              <label htmlFor="itemQuantity" className="block text-sm font-medium text-gray-700 mb-1">Quantity</label>
              <input
                type="number"
                id="itemQuantity"
                value={itemQuantity}
                onChange={(e) => setItemQuantity(Math.max(1, parseInt(e.target.value, 10) || 1))} // Ensure at least 1
                min="1"
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-200"
              />
            </div>
            <div>
              <label htmlFor="itemPrice" className="block text-sm font-medium text-gray-700 mb-1">Price (per unit)</label>
              <input
                type="number"
                id="itemPrice"
                value={itemPrice}
                onChange={(e) => setItemPrice(e.target.value)}
                placeholder="e.g., 12.50"
                step="0.01"
                min="0"
                className="w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-200"
              />
            </div>
            <button
              onClick={handleAddItem}
              className="col-span-full md:col-span-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-0.5"
            >
              Add Item
            </button>
          </div>
        </div>

        {/* Bill Details Section (for adding/removing items) */}
        <div className="mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200 shadow-inner">
          <h2 className="text-2xl font-bold text-gray-800 mb-5">Bill Items Management</h2>
          {items.length === 0 && (
            <p className="text-center text-gray-500 py-8">No items added yet. Add items above to see the bill.</p>
          )}
          {items.length > 0 && (
            <div className="overflow-x-auto mb-6">
              <table className="min-w-full bg-white rounded-lg overflow-hidden shadow-sm border border-gray-200">
                  <thead className={`${appCurrentStyle.tableHeaderBgClass} border-b border-gray-200`}><tr>
                    <th className={`${appBaseThClasses} ${billTemplate === 'bold' || billTemplate === 'dark-accent' ? 'text-white' : 'text-gray-700'}`}>Item</th><th className={`${appBaseThClasses} ${billTemplate === 'bold' || billTemplate === 'dark-accent' ? 'text-white' : 'text-gray-700'}`}>Qty</th><th className={`${appBaseThClasses} ${billTemplate === 'bold' || billTemplate === 'dark-accent' ? 'text-white' : 'text-gray-700'}`}>Price</th><th className={`${appBaseThClasses} ${billTemplate === 'bold' || billTemplate === 'dark-accent' ? 'text-white' : 'text-gray-700'}`}>Total</th><th className={`${appBaseThClasses} ${billTemplate === 'bold' || billTemplate === 'dark-accent' ? 'text-white' : 'text-gray-700'}`}></th>
                  </tr></thead>
                  <tbody>
                    {items.map((item) => (
                      <tr key={item.id} className={`${appCurrentStyle.tableRowBorderClass} last:border-b-0`}><td className={`${appBaseTdClasses} ${appCurrentStyle.tableCellPaddingClass}`}>{item.name}</td><td className={`${appBaseTdClasses} ${appCurrentStyle.tableCellPaddingClass}`}>{item.quantity}</td><td className={`${appBaseTdClasses} ${appCurrentStyle.tableCellPaddingClass}`}>{getCurrencySymbol(currency)}{(item.price).toFixed(2)}</td><td className={`${appBaseTdClasses} ${appCurrentStyle.tableCellPaddingClass}`}>{getCurrencySymbol(currency)}{(item.quantity * item.price).toFixed(2)}</td><td className="py-3 px-4">
                          <button
                            onClick={() => handleRemoveItem(item.id)}
                            className="text-red-500 hover:text-red-700 transition duration-200"
                            title="Remove Item"
                          >
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                              <path fillRule="evenodd" d={deleteIconPath} clipRule="evenodd" />
                            </svg>
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
          )}
        </div>

        {/* Action Buttons */}
        <div className="flex justify-center space-x-4 mb-8">
          <button
            onClick={handleClearAll}
            className="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-0.5"
          >
            Clear All
          </button>
          <div className="relative">
            <label htmlFor="taxRate" className="sr-only">Tax Rate</label>
            <input
              type="number"
              id="taxRate"
              value={taxRate}
              onChange={(e) => setTaxRate(Math.max(0, parseFloat(e.target.value) || 0))}
              min="0"
              step="0.1"
              className="w-24 p-3 border border-gray-300 rounded-md text-center focus:ring-blue-500 focus:border-blue-500 transition duration-200 appearance-none"
              aria-label="Set Tax Rate Percentage"
            />
            <span className="absolute inset-y-0 right-3 flex items-center text-gray-500 pointer-events-none">%</span>
          </div>
          <button
            onClick={handleGeneratePdf}
            className="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-0.5"
            disabled={pdfLoading || items.length === 0}
          >
            {pdfLoading ? 'Generating PDF...' : 'Save as PDF'}
          </button>
        </div>

        {/* Bill Preview Template Selector */}
        <div className="mb-8 p-6 bg-purple-50 rounded-lg border border-purple-200 shadow-inner">
          <h2 className="text-2xl font-bold text-purple-800 mb-4">Choose Bill Preview Template</h2>
          <select
            id="billTemplate"
            value={billTemplate}
            onChange={(e) => setBillTemplate(e.target.value)}
            className="w-full p-3 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500 transition duration-200 bg-white"
          >
            <option value="modern">Modern Template</option>
            <option value="classic">Classic Template</option>
            <option value="minimal">Minimal Template</option>
            <option value="crushed">Crushed Paper Template (Random)</option>
            <option value="crushed-A">Crushed Paper Template (A)</option>
            <option value="crushed-B">Crushed Paper Template (B)</option>
            <option value="crushed-C">Crushed Paper Template (C)</option>
            <option value="crushed-D">Crushed Paper Template (D)</option>
            <option value="crushed-E">Crushed Paper Template (E)</option>
            <option value="receipt">Receipt Style Template</option>
            <option value="bold">Bold & Clean Template</option>
            <option value="retro-dot-matrix">Retro Dot Matrix Template</option>
            <option value="clean-boxed">Clean Boxed Template</option>
            <option value="elegant-line">Elegant Line Template</option>
            <option value="dark-accent">Dark Accent Template</option>
            <option value="simple-grid">Simple Grid Template</option>
            <option value="modern-compact">Modern Compact Template</option>
            <option value="elegant-minimal">Elegant Minimal Template</option>
            <option value="dark-professional">Dark Professional Template</option>
            <option value="colorful-gradient">Colorful Gradient Template</option>
            <option value="corporate-clean">Corporate Clean Template</option>
            <option value="rustic-charm">Rustic Charm Template</option>
          </select>
        </div>

        {/* Bill Preview Section - Renders based on selected template */}
        <BillPreview template={billTemplate} billPreviewRef={billPreviewRef} />
      </div>
    </div>
  );
};

export default App;
